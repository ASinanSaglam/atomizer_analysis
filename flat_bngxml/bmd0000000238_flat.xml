<?xml version="1.0" encoding="UTF-8"?>
<!-- Created by BioNetGen 2.6.0  -->
<sbml xmlns="http://www.sbml.org/sbml/level3" level="3" version="1">
  <model id="bmd0000000238_flat">
    <ListOfParameters>
      <Parameter id="T_a" type="Constant" value="21" expr="21.0"/>
      <Parameter id="T_b" type="Constant" value="38" expr="38.0"/>
      <Parameter id="delta_T" type="Constant" value="1.57" expr="1.57"/>
      <Parameter id="kinc" type="Constant" value="0.0258" expr="0.0258"/>
      <Parameter id="tdose1" type="Constant" value="24" expr="24.0"/>
      <Parameter id="tdose2" type="Constant" value="72" expr="72.0"/>
      <Parameter id="tdose3" type="Constant" value="120" expr="120.0"/>
      <Parameter id="t_day" type="Constant" value="17.5" expr="17.5"/>
      <Parameter id="t_night" type="Constant" value="6.73" expr="6.73"/>
      <Parameter id="day_length" type="Constant" value="86400" expr="86400.0"/>
      <Parameter id="km" type="Constant" value="1.1375" expr="1.1375"/>
      <Parameter id="c" type="Constant" value="3.47" expr="3.47"/>
      <Parameter id="pEtot" type="Constant" value="0.144" expr="0.144"/>
      <Parameter id="kR" type="Constant" value="5.35" expr="5.35"/>
      <Parameter id="AMT_dose" type="Constant" value="3" expr="3.0"/>
      <Parameter id="pEf1" type="Constant" value="1" expr="1.0"/>
      <Parameter id="pEs1" type="Constant" value="0.2" expr="0.2"/>
      <Parameter id="pEf2" type="Constant" value="3.57" expr="3.57"/>
      <Parameter id="pEs2" type="Constant" value="2.43" expr="2.43"/>
      <Parameter id="pEf3" type="Constant" value="8" expr="8.0"/>
      <Parameter id="pEs3" type="Constant" value="50" expr="50.0"/>
      <Parameter id="M_b" type="Constant" value="3" expr="3.0"/>
      <Parameter id="t_prime" type="Constant" value="45.12" expr="45.12"/>
      <Parameter id="alpha" type="Constant" value="0.2229166" expr="0.2229166"/>
      <Parameter id="delta_high_dose" type="Constant" value="1" expr="1.0"/>
      <Parameter id="Ns" type="Constant" value="4" expr="4.0"/>
      <Parameter id="Nf" type="Constant" value="4" expr="4.0"/>
      <Parameter id="Ts" type="Constant" value="2.45" expr="2.45"/>
      <Parameter id="Tf" type="Constant" value="0.368" expr="0.368"/>
    </ListOfParameters>
    <ListOfMoleculeTypes>
      <MoleculeType id="BR"/>
      <MoleculeType id="M"/>
      <MoleculeType id="T"/>
    </ListOfMoleculeTypes>
    <ListOfCompartments>
      <compartment id="COMpartment" spatialDimensions="3" size="1.0"/>
    </ListOfCompartments>
    <ListOfSpecies>
      <Species id="S1"  concentration="3.5" name="@COMpartment::M()" compartment="COMpartment">
        <ListOfMolecules>
          <Molecule id="S1_M1" name="M" compartment="COMpartment"/>
        </ListOfMolecules>
      </Species>
      <Species id="S2"  concentration="38.785" name="@COMpartment::T()" compartment="COMpartment">
        <ListOfMolecules>
          <Molecule id="S2_M1" name="T" compartment="COMpartment"/>
        </ListOfMolecules>
      </Species>
      <Species id="S3"  concentration="0" name="@COMpartment::BR()" compartment="COMpartment">
        <ListOfMolecules>
          <Molecule id="S3_M1" name="BR" compartment="COMpartment"/>
        </ListOfMolecules>
      </Species>
    </ListOfSpecies>
    <ListOfReactionRules>
      <ReactionRule id="RR1" name="_R1" symmetry_factor="1">
        <ListOfReactantPatterns>
        </ListOfReactantPatterns>
        <ListOfProductPatterns>
          <ProductPattern id="RR1_PP1">
            <ListOfMolecules>
              <Molecule id="RR1_PP1_M1" name="M" compartment="COMpartment"/>
            </ListOfMolecules>
          </ProductPattern>
        </ListOfProductPatterns>
        <RateLaw id="RR1_RateLaw" type="Function" name="arRateM" totalrate="0">
          <ListOfArguments>
          </ListOfArguments>
        </RateLaw>
        <Map>
        </Map>
        <ListOfOperations>
          <Add id="RR1_PP1_M1"/>
        </ListOfOperations>
      </ReactionRule>
      <ReactionRule id="RR2" name="_R2" symmetry_factor="1">
        <ListOfReactantPatterns>
        </ListOfReactantPatterns>
        <ListOfProductPatterns>
          <ProductPattern id="RR2_PP1">
            <ListOfMolecules>
              <Molecule id="RR2_PP1_M1" name="T" compartment="COMpartment"/>
            </ListOfMolecules>
          </ProductPattern>
        </ListOfProductPatterns>
        <RateLaw id="RR2_RateLaw" type="Function" name="arRateT" totalrate="0">
          <ListOfArguments>
          </ListOfArguments>
        </RateLaw>
        <Map>
        </Map>
        <ListOfOperations>
          <Add id="RR2_PP1_M1"/>
        </ListOfOperations>
      </ReactionRule>
      <ReactionRule id="RR3" name="_R3" symmetry_factor="1">
        <ListOfReactantPatterns>
        </ListOfReactantPatterns>
        <ListOfProductPatterns>
          <ProductPattern id="RR3_PP1">
            <ListOfMolecules>
              <Molecule id="RR3_PP1_M1" name="BR" compartment="COMpartment"/>
            </ListOfMolecules>
          </ProductPattern>
        </ListOfProductPatterns>
        <RateLaw id="RR3_RateLaw" type="Function" name="arRateBR" totalrate="0">
          <ListOfArguments>
          </ListOfArguments>
        </RateLaw>
        <Map>
        </Map>
        <ListOfOperations>
          <Add id="RR3_PP1_M1"/>
        </ListOfOperations>
      </ReactionRule>
    </ListOfReactionRules>
    <ListOfObservables>
      <Observable id="O1" name="M" type="Species">
        <ListOfPatterns>
          <Pattern id="O1_P1" matchOnce="1">
            <ListOfMolecules>
              <Molecule id="O1_P1_M1" name="M"/>
            </ListOfMolecules>
          </Pattern>
        </ListOfPatterns>
      </Observable>
      <Observable id="O2" name="T" type="Species">
        <ListOfPatterns>
          <Pattern id="O2_P1" matchOnce="1">
            <ListOfMolecules>
              <Molecule id="O2_P1_M1" name="T"/>
            </ListOfMolecules>
          </Pattern>
        </ListOfPatterns>
      </Observable>
      <Observable id="O3" name="BR" type="Species">
        <ListOfPatterns>
          <Pattern id="O3_P1" matchOnce="1">
            <ListOfMolecules>
              <Molecule id="O3_P1_M1" name="BR"/>
            </ListOfMolecules>
          </Pattern>
        </ListOfPatterns>
      </Observable>
    </ListOfObservables>
    <ListOfFunctions>
      <Function id="X2">
        <ListOfReferences>
          <Reference name="tdose2" type="Constant"/>
        </ListOfReferences>
        <Expression> ((-tdose2)/24)+(time()/24) </Expression>
      </Function>
      <Function id="Kf">
        <ListOfReferences>
          <Reference name="Nf" type="Constant"/>
          <Reference name="Tf" type="Constant"/>
        </ListOfReferences>
        <Expression> Nf/Tf </Expression>
      </Function>
      <Function id="gNfTf2">
        <ListOfReferences>
          <Reference name="Nf" type="Constant"/>
          <Reference name="Kf" type="Function"/>
          <Reference name="X2" type="Function"/>
        </ListOfReferences>
        <Expression> if((X2&gt;0),((((Kf^Nf)*(X2^(Nf-1)))*exp(((-Kf)*X2)))/6),0) </Expression>
      </Function>
      <Function id="X3">
        <ListOfReferences>
          <Reference name="tdose3" type="Constant"/>
        </ListOfReferences>
        <Expression> ((-tdose3)/24)+(time()/24) </Expression>
      </Function>
      <Function id="gNfTf3">
        <ListOfReferences>
          <Reference name="Nf" type="Constant"/>
          <Reference name="Kf" type="Function"/>
          <Reference name="X3" type="Function"/>
        </ListOfReferences>
        <Expression> if((X3&gt;0),((((Kf^Nf)*(X3^(Nf-1)))*exp(((-Kf)*X3)))/6),0) </Expression>
      </Function>
      <Function id="X1">
        <ListOfReferences>
          <Reference name="tdose1" type="Constant"/>
        </ListOfReferences>
        <Expression> ((-tdose1)/24)+(time()/24) </Expression>
      </Function>
      <Function id="gNfTf1">
        <ListOfReferences>
          <Reference name="Nf" type="Constant"/>
          <Reference name="Kf" type="Function"/>
          <Reference name="X1" type="Function"/>
        </ListOfReferences>
        <Expression> if((X1&gt;0),((((Kf^Nf)*(X1^(Nf-1)))*exp(((-Kf)*X1)))/6),0) </Expression>
      </Function>
      <Function id="E_fast">
        <ListOfReferences>
          <Reference name="pEf2" type="Constant"/>
          <Reference name="gNfTf1" type="Function"/>
          <Reference name="gNfTf2" type="Function"/>
          <Reference name="gNfTf3" type="Function"/>
        </ListOfReferences>
        <Expression> pEf2*((gNfTf1+gNfTf2)+gNfTf3) </Expression>
      </Function>
      <Function id="f_prime">
        <ListOfReferences>
          <Reference name="alpha" type="Constant"/>
          <Reference name="delta_high_dose" type="Constant"/>
          <Reference name="t_prime" type="Constant"/>
          <Reference name="tdose1" type="Constant"/>
        </ListOfReferences>
        <Expression> delta_high_dose/(exp(((-alpha)*(((-t_prime)-tdose1)+time())))+1) </Expression>
      </Function>
      <Function id="Ks">
        <ListOfReferences>
          <Reference name="Ns" type="Constant"/>
          <Reference name="Ts" type="Constant"/>
        </ListOfReferences>
        <Expression> Ns/Ts </Expression>
      </Function>
      <Function id="gNsTs2">
        <ListOfReferences>
          <Reference name="Ns" type="Constant"/>
          <Reference name="Ks" type="Function"/>
          <Reference name="X2" type="Function"/>
        </ListOfReferences>
        <Expression> if((X2&gt;0),((((Ks^Ns)*(X2^(Ns-1)))*exp(((-Ks)*X2)))/6),0) </Expression>
      </Function>
      <Function id="gNsTs3">
        <ListOfReferences>
          <Reference name="Ns" type="Constant"/>
          <Reference name="Ks" type="Function"/>
          <Reference name="X3" type="Function"/>
        </ListOfReferences>
        <Expression> if((X3&gt;0),((((Ks^Ns)*(X3^(Ns-1)))*exp(((-Ks)*X3)))/6),0) </Expression>
      </Function>
      <Function id="gNsTs1">
        <ListOfReferences>
          <Reference name="Ns" type="Constant"/>
          <Reference name="Ks" type="Function"/>
          <Reference name="X1" type="Function"/>
        </ListOfReferences>
        <Expression> if((X1&gt;0),((((Ks^Ns)*(X1^(Ns-1)))*exp(((-Ks)*X1)))/6),0) </Expression>
      </Function>
      <Function id="E_slow">
        <ListOfReferences>
          <Reference name="AMT_dose" type="Constant"/>
          <Reference name="pEs2" type="Constant"/>
          <Reference name="gNsTs1" type="Function"/>
          <Reference name="gNsTs2" type="Function"/>
          <Reference name="gNsTs3" type="Function"/>
        </ListOfReferences>
        <Expression> (AMT_dose*pEs2)*((gNsTs1+gNsTs2)+gNsTs3) </Expression>
      </Function>
      <Function id="arRateBR">
        <ListOfReferences>
          <Reference name="kR" type="Constant"/>
          <Reference name="E_fast" type="Function"/>
          <Reference name="E_slow" type="Function"/>
          <Reference name="f_prime" type="Function"/>
          <Reference name="BR" type="Observable"/>
        </ListOfReferences>
        <Expression> ((-BR)*kR)+((f_prime*(1-BR))*(E_fast+E_slow)) </Expression>
      </Function>
      <Function id="T_day">
        <ListOfReferences>
          <Reference name="T_b" type="Constant"/>
          <Reference name="delta_T" type="Constant"/>
        </ListOfReferences>
        <Expression> T_b+(delta_T/2) </Expression>
      </Function>
      <Function id="kb">
        <ListOfReferences>
          <Reference name="M_b" type="Constant"/>
          <Reference name="T_a" type="Constant"/>
          <Reference name="T_b" type="Constant"/>
        </ListOfReferences>
        <Expression> M_b/((-T_a)+T_b) </Expression>
      </Function>
      <Function id="M_day">
        <ListOfReferences>
          <Reference name="T_a" type="Constant"/>
          <Reference name="T_b" type="Constant"/>
          <Reference name="kinc" type="Constant"/>
          <Reference name="T_day" type="Function"/>
          <Reference name="kb" type="Function"/>
        </ListOfReferences>
        <Expression> ((-T_a)+T_day)*(kb+(kinc*((-T_b)+T_day))) </Expression>
      </Function>
      <Function id="T_night">
        <ListOfReferences>
          <Reference name="T_b" type="Constant"/>
          <Reference name="delta_T" type="Constant"/>
        </ListOfReferences>
        <Expression> T_b-(delta_T/2) </Expression>
      </Function>
      <Function id="M_night_baseline">
        <ListOfReferences>
          <Reference name="T_a" type="Constant"/>
          <Reference name="T_b" type="Constant"/>
          <Reference name="kinc" type="Constant"/>
          <Reference name="T_night" type="Function"/>
          <Reference name="kb" type="Function"/>
        </ListOfReferences>
        <Expression> ((-T_a)+T_night)*(kb+(kinc*((-T_b)+T_night))) </Expression>
      </Function>
      <Function id="M_night">
        <ListOfReferences>
          <Reference name="M_day" type="Function"/>
          <Reference name="M_night_baseline" type="Function"/>
          <Reference name="f_prime" type="Function"/>
        </ListOfReferences>
        <Expression> (M_day*f_prime)+(M_night_baseline*(1-f_prime)) </Expression>
      </Function>
      <Function id="f2_drug">
        <ListOfReferences>
        </ListOfReferences>
        <Expression> 0 </Expression>
      </Function>
      <Function id="k">
        <ListOfReferences>
          <Reference name="T_b" type="Constant"/>
          <Reference name="kinc" type="Constant"/>
          <Reference name="pEtot" type="Constant"/>
          <Reference name="f2_drug" type="Function"/>
          <Reference name="kb" type="Function"/>
          <Reference name="BR" type="Observable"/>
          <Reference name="T" type="Observable"/>
        </ListOfReferences>
        <Expression> (f2_drug+kb)+(kinc*(T-(T_b*((BR*pEtot)+1)))) </Expression>
      </Function>
      <Function id="arRateT">
        <ListOfReferences>
          <Reference name="T_a" type="Constant"/>
          <Reference name="c" type="Constant"/>
          <Reference name="k" type="Function"/>
          <Reference name="M" type="Observable"/>
          <Reference name="T" type="Observable"/>
        </ListOfReferences>
        <Expression> (M-(k*(T-T_a)))/c </Expression>
      </Function>
      <Function id="tprime">
        <ListOfReferences>
          <Reference name="day_length" type="Constant"/>
        </ListOfReferences>
        <Expression> ((-day_length)*min(rint((-0.5+((3600*time())/day_length))),rint((0.5+((3600*time())/day_length)))))+(3600*time()) </Expression>
      </Function>
      <Function id="M_c">
        <ListOfReferences>
          <Reference name="t_day" type="Constant"/>
          <Reference name="t_night" type="Constant"/>
          <Reference name="M_day" type="Function"/>
          <Reference name="M_night" type="Function"/>
          <Reference name="tprime" type="Function"/>
        </ListOfReferences>
        <Expression> if((((tprime/3600)&gt;=t_night)and((tprime/3600)&lt;t_day)),M_night,M_day) </Expression>
      </Function>
      <Function id="arRateM">
        <ListOfReferences>
          <Reference name="km" type="Constant"/>
          <Reference name="M_c" type="Function"/>
          <Reference name="M" type="Observable"/>
        </ListOfReferences>
        <Expression> (-km)*(M-M_c) </Expression>
      </Function>
    </ListOfFunctions>
  </model>
</sbml>
